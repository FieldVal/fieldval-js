var logger;"function"==typeof require&&(logger=require("tracer").console()),Validator=function(r){var e=this;e.validating=r,e.missing_keys={},e.missing_count=0,e.invalid_keys={},e.invalid_count=0,e.unrecognized_keys={},e.unrecognized_count=0,e.recognized_keys={}},Validator.REQUIRED_ERROR="required",Validator.NOT_REQUIRED_BUT_MISSING="notrequired",Validator.ONE_OR_MORE_ERRORS=0,Validator.FIELD_MISSING=1,Validator.INCORRECT_FIELD_TYPE=2,Validator.FIELD_UNRECOGNIZED=3,Validator.MULTIPLE_ERRORS=4,Validator.get_value_and_type=function(r,e){if("integer"==e){var i=parseInt(r);isNaN(i)||(""+i).length!=(""+r).length||(r=i,e=i,e="number")}else if("float"==e){var i=parseFloat(r);isNaN(i)||(r=i,e="number")}var t=typeof r;return"object"==t&&"[object Array]"===Object.prototype.toString.call(r)&&(t="array"),{type:t,desired_type:e,value:r}},Validator.required=function(r,e){var i=function(e){return null==e?r||void 0===r?Validator.REQUIRED_ERROR:Validator.NOT_REQUIRED_BUT_MISSING:void 0};return void 0!==e?(e.operator=i,e):i},Validator.type=function(r,e,i){"object"==typeof e&&(i=e,e="undefined"!=typeof i.required?i.required:!0);var t=function(i){var t=Validator.required(e)(i);if(t)return t;var n=Validator.get_value_and_type(i,r);r=n.desired_type;var o=n.type,i=n.value;return o!==r?{error_message:"Incorrect field type. Expected "+r+".",error:Validator.INCORRECT_FIELD_TYPE,expected:r,received:o}:void 0};return void 0!==i?(i.operator=t,i):t},Validator.prototype={"default":function(r){var e=this;return{get:function(){var i=e.get.apply(e,arguments);return"undefined"!=typeof i?i:r}}},get:function(r){var e=this,i=e.validating[r];if(e.recognized_keys[r]=!0,arguments.length>1){for(var t=!1,n=!1,o=function(a){var u;if("object"==typeof a){if("[object Array]"===Object.prototype.toString.call(a)){for(var d=0;d<a.length&&(o(a[d]),!n);d++);return}if(0==a.length)return;flags=a,u=flags.operator,null!=flags&&flags.stop_if_error&&(stop_if_error=!0)}else u=a,stop_if_error=!0;var l=u(i,function(r){i=r});null!=l&&(l===Validator.REQUIRED_ERROR?(e.missing(r),t=!0):l===Validator.NOT_REQUIRED_BUT_MISSING?t=!0:(e.invalid(r,l),t=!0),stop_if_error&&(n=!0))},a=1;a<arguments.length;a++){var u=arguments[a];if(o(u),n)break}if(t)return void 0}return i},invalid:function(r,e){var i=this,t=i.invalid_keys[r];return null!=t?null!=t.errors?t.errors.push(e):i.invalid_keys[r]={error:Validator.MULTIPLE_ERRORS,error_message:"Multiple errors.",errors:[t,e]}:(i.invalid_keys[r]=e,i.invalid_count++),this},missing:function(r){var e=this;return e.missing_keys[r]={error_message:"Field missing.",error:Validator.FIELD_MISSING},e.missing_count++,this},unrecognized:function(r){var e=this;return e.unrecognized_keys[r]={error_message:"Unrecognized field.",error:Validator.FIELD_UNRECOGNIZED},e.unrecognized_count++,this},recognized:function(r){var e=this;e.recognized_keys[r]=!0},get_unrecognized:function(){var r=this,e=[];for(var i in r.validating)1!=r.recognized_keys[i]&&e.push(i);return e},end:function(){var r=this,e={},i=!1,t=r.get_unrecognized();for(var n in t)r.unrecognized(t[n]);return 0!==r.missing_count&&(e.missing=r.missing_keys,i=!0),0!==r.invalid_count&&(e.invalid=r.invalid_keys,i=!0),0!==r.unrecognized_count&&(e.unrecognized=r.unrecognized_keys,i=!0),i?(e.error_message="One or more errors.",e.error=Validator.ONE_OR_MORE_ERRORS,e):null}},Validator.Error=function(r,e,i){if("object"==typeof r&&"[object Array]"===Object.prototype.toString.call(r)){var t=r;r=t[0],e=t[1],i=t[2]}var n={error:r};return null!=e&&(n.error_message=e),null!=i&&(n.data=i),n},"undefined"!=typeof module&&(module.exports=Validator);